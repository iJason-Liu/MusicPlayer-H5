# ğŸ” ç™»å½•è®¤è¯æŒ‡å—

## åŠŸèƒ½è¯´æ˜

é¡¹ç›®å·²å®ç°å®Œæ•´çš„ç™»å½•è®¤è¯ç³»ç»Ÿï¼Œæ‰€æœ‰é¡µé¢éƒ½éœ€è¦ç™»å½•æ‰èƒ½è®¿é—®ï¼Œé˜²æ­¢é€šè¿‡ URL ç›´æ¥è®¿é—®ã€‚

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

### 1. ç™»å½•é¡µé¢

- ç”¨æˆ·åå¯†ç ç™»å½•
- å›è½¦é”®å¿«æ·ç™»å½•
- ç™»å½•çŠ¶æ€æŒä¹…åŒ–
- ç™»å½•åè·³è½¬åˆ°åŸç›®æ ‡é¡µé¢

### 2. è·¯ç”±å®ˆå«

- è‡ªåŠ¨æ‹¦æˆªæœªç™»å½•ç”¨æˆ·
- ä¿å­˜åŸå§‹è®¿é—®è·¯å¾„
- ç™»å½•åè‡ªåŠ¨è·³è½¬å›å»

### 3. å¼€å‘æ¨¡å¼

- å¼€å‘ç¯å¢ƒè‡ªåŠ¨è·³è¿‡ç™»å½•éªŒè¯
- ç”Ÿäº§ç¯å¢ƒå¼ºåˆ¶ç™»å½•
- å¯é€šè¿‡ç¯å¢ƒå˜é‡æ§åˆ¶

## ğŸ”§ å¼€å‘æ¨¡å¼æ§åˆ¶

### è‡ªåŠ¨æ£€æµ‹ï¼ˆæ¨èï¼‰

ç³»ç»Ÿä¼šè‡ªåŠ¨æ£€æµ‹è¿è¡Œç¯å¢ƒï¼š

```javascript
// å¼€å‘ç¯å¢ƒï¼ˆnpm run devï¼‰
DEV_MODE = true; // è‡ªåŠ¨è·³è¿‡ç™»å½•

// ç”Ÿäº§ç¯å¢ƒï¼ˆnpm run buildï¼‰
DEV_MODE = false; // å¼ºåˆ¶ç™»å½•
```

### æ‰‹åŠ¨æ§åˆ¶

å¦‚æœéœ€è¦æ‰‹åŠ¨æ§åˆ¶ï¼Œä¿®æ”¹ `frontend/src/stores/user.js`ï¼š

```javascript
// æ–¹å¼1ï¼šå§‹ç»ˆå¼€å¯å¼€å‘æ¨¡å¼
const DEV_MODE = true;

// æ–¹å¼2ï¼šå§‹ç»ˆå…³é—­å¼€å‘æ¨¡å¼
const DEV_MODE = false;

// æ–¹å¼3ï¼šæ ¹æ®ç¯å¢ƒå˜é‡ï¼ˆæ¨èï¼‰
const DEV_MODE = import.meta.env.DEV;

// æ–¹å¼4ï¼šè‡ªå®šä¹‰ç¯å¢ƒå˜é‡
const DEV_MODE = import.meta.env.VITE_DEV_MODE === "true";
```

## ğŸ“ ä½¿ç”¨è¯´æ˜

### å¼€å‘ç¯å¢ƒ

```bash
# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev

# å¼€å‘æ¨¡å¼ä¸‹ï¼š
# - å¯ä»¥ç›´æ¥è®¿é—®ä»»ä½•é¡µé¢
# - ä¸éœ€è¦ç™»å½•
# - ç™»å½•é¡µé¢ä¼šæ˜¾ç¤º"å¼€å‘æ¨¡å¼"æç¤º
```

### ç”Ÿäº§ç¯å¢ƒ

```bash
# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build

# ç”Ÿäº§ç¯å¢ƒä¸‹ï¼š
# - å¿…é¡»å…ˆç™»å½•
# - æœªç™»å½•è®¿é—®ä»»ä½•é¡µé¢éƒ½ä¼šè·³è½¬åˆ°ç™»å½•é¡µ
# - ç™»å½•åè·³è½¬å›åŸé¡µé¢
```

## ğŸ”‘ ç™»å½•ä¿¡æ¯

### æµ‹è¯•è´¦å·

å¼€å‘ç¯å¢ƒä¸‹ï¼Œä»»æ„ç”¨æˆ·åå’Œå¯†ç éƒ½å¯ä»¥ç™»å½•ï¼š

```
ç”¨æˆ·åï¼šä»»æ„
å¯†ç ï¼šä»»æ„
```

### ç”Ÿäº§ç¯å¢ƒ

éœ€è¦å¯¹æ¥çœŸå®çš„åç«¯ APIï¼š

1. ä¿®æ”¹ `frontend/src/stores/user.js` ä¸­çš„ `login` æ–¹æ³•
2. æ›¿æ¢ä¸ºçœŸå®çš„ API è¯·æ±‚
3. å¤„ç†çœŸå®çš„ token å’Œç”¨æˆ·ä¿¡æ¯

## ğŸ“ è·¯ç”±é…ç½®

### éœ€è¦ç™»å½•çš„é¡µé¢

```javascript
{
  path: '/home',
  meta: { requiresAuth: true }  // éœ€è¦ç™»å½•
}
```

### ä¸éœ€è¦ç™»å½•çš„é¡µé¢

```javascript
{
  path: '/login',
  meta: { requiresAuth: false }  // ä¸éœ€è¦ç™»å½•
}
```

## ğŸ”„ å·¥ä½œæµç¨‹

### 1. ç”¨æˆ·è®¿é—®é¡µé¢

```
ç”¨æˆ·è®¿é—® /home
  â†“
è·¯ç”±å®ˆå«æ£€æŸ¥
  â†“
æ˜¯å¦éœ€è¦ç™»å½•ï¼Ÿ
  â”œâ”€ æ˜¯ â†’ å·²ç™»å½•ï¼Ÿ
  â”‚   â”œâ”€ æ˜¯ â†’ å…è®¸è®¿é—®
  â”‚   â””â”€ å¦ â†’ è·³è½¬ç™»å½•é¡µï¼ˆä¿å­˜åŸè·¯å¾„ï¼‰
  â””â”€ å¦ â†’ å…è®¸è®¿é—®
```

### 2. ç™»å½•æµç¨‹

```
ç”¨æˆ·è¾“å…¥è´¦å·å¯†ç 
  â†“
ç‚¹å‡»ç™»å½•
  â†“
éªŒè¯æˆåŠŸ
  â†“
ä¿å­˜ token å’Œç”¨æˆ·ä¿¡æ¯
  â†“
è·³è½¬åˆ°åŸç›®æ ‡é¡µé¢ï¼ˆæˆ–é¦–é¡µï¼‰
```

### 3. é€€å‡ºç™»å½•

```
ç‚¹å‡»é€€å‡ºç™»å½•
  â†“
ç¡®è®¤å¯¹è¯æ¡†
  â†“
æ¸…é™¤ token å’Œç”¨æˆ·ä¿¡æ¯
  â†“
è·³è½¬åˆ°ç™»å½•é¡µ
```

## ğŸ“ ç›¸å…³æ–‡ä»¶

### æ ¸å¿ƒæ–‡ä»¶

1. **ç”¨æˆ·çŠ¶æ€ç®¡ç†**

   - `frontend/src/stores/user.js`
   - ç®¡ç†ç™»å½•çŠ¶æ€ã€ç”¨æˆ·ä¿¡æ¯ã€token

2. **ç™»å½•é¡µé¢**

   - `frontend/src/views/Login.vue`
   - ç™»å½•è¡¨å•ã€éªŒè¯é€»è¾‘

3. **è·¯ç”±é…ç½®**

   - `frontend/src/router/index.js`
   - è·¯ç”±å®ˆå«ã€æƒé™éªŒè¯

4. **æˆ‘çš„é¡µé¢**
   - `frontend/src/views/Mine.vue`
   - é€€å‡ºç™»å½•åŠŸèƒ½

## ğŸ¨ ç™»å½•é¡µé¢æ ·å¼

- æ¸å˜èƒŒæ™¯
- æ¯›ç»ç’ƒæ•ˆæœ
- å›¾æ ‡è¾“å…¥æ¡†
- å“åº”å¼è®¾è®¡
- å¼€å‘æ¨¡å¼æç¤º

## ğŸ”’ å®‰å…¨ç‰¹æ€§

### å·²å®ç°

- âœ… è·¯ç”±å®ˆå«æ‹¦æˆª
- âœ… Token æŒä¹…åŒ–
- âœ… ç™»å½•çŠ¶æ€éªŒè¯
- âœ… è‡ªåŠ¨è·³è½¬ç™»å½•é¡µ
- âœ… åŸè·¯å¾„ä¿å­˜

### å»ºè®®å¢å¼º

- [ ] Token è¿‡æœŸæ£€æµ‹
- [ ] è‡ªåŠ¨åˆ·æ–° Token
- [ ] è¯·æ±‚æ‹¦æˆªå™¨æ·»åŠ  Token
- [ ] æ¥å£æƒé™éªŒè¯
- [ ] å¯†ç åŠ å¯†ä¼ è¾“

## ğŸ§ª æµ‹è¯•åœºæ™¯

### åœºæ™¯ 1ï¼šæœªç™»å½•è®¿é—®

```
1. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜
2. è®¿é—® http://localhost:3000/home
3. åº”è¯¥è‡ªåŠ¨è·³è½¬åˆ° /login?redirect=/home
4. ç™»å½•åè‡ªåŠ¨è·³è½¬å› /home
```

### åœºæ™¯ 2ï¼šå·²ç™»å½•è®¿é—®

```
1. ç™»å½•æˆåŠŸ
2. åˆ·æ–°é¡µé¢
3. åº”è¯¥ä¿æŒç™»å½•çŠ¶æ€
4. å¯ä»¥æ­£å¸¸è®¿é—®æ‰€æœ‰é¡µé¢
```

### åœºæ™¯ 3ï¼šé€€å‡ºç™»å½•

```
1. åœ¨"æˆ‘çš„"é¡µé¢ç‚¹å‡»é€€å‡ºç™»å½•
2. ç¡®è®¤é€€å‡º
3. åº”è¯¥è·³è½¬åˆ°ç™»å½•é¡µ
4. å†æ¬¡è®¿é—®å…¶ä»–é¡µé¢åº”è¯¥è¢«æ‹¦æˆª
```

### åœºæ™¯ 4ï¼šå¼€å‘æ¨¡å¼

```
1. å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼ˆnpm run devï¼‰
2. ç›´æ¥è®¿é—®ä»»ä½•é¡µé¢
3. åº”è¯¥å¯ä»¥æ­£å¸¸è®¿é—®ï¼ˆä¸éœ€è¦ç™»å½•ï¼‰
4. ç™»å½•é¡µæ˜¾ç¤º"å¼€å‘æ¨¡å¼"æç¤º
```

## ğŸ’¡ å¸¸è§é—®é¢˜

### Q1: å¦‚ä½•å…³é—­ç™»å½•éªŒè¯ï¼Ÿ

A: ä¿®æ”¹ `frontend/src/stores/user.js`ï¼š

```javascript
const DEV_MODE = true; // å§‹ç»ˆå¼€å¯å¼€å‘æ¨¡å¼
```

### Q2: å¦‚ä½•å¯¹æ¥çœŸå® APIï¼Ÿ

A: ä¿®æ”¹ `login` æ–¹æ³•ï¼š

```javascript
const login = async (username, password) => {
	const res = await axios.post("/api/login", { username, password });
	token.value = res.data.token;
	userInfo.value = res.data.user;
	// ...
};
```

### Q3: å¦‚ä½•è‡ªå®šä¹‰ç™»å½•é¡µé¢ï¼Ÿ

A: ç¼–è¾‘ `frontend/src/views/Login.vue`

### Q4: å¦‚ä½•æ·»åŠ ä¸éœ€è¦ç™»å½•çš„é¡µé¢ï¼Ÿ

A: åœ¨è·¯ç”±é…ç½®ä¸­è®¾ç½®ï¼š

```javascript
{
  path: '/about',
  meta: { requiresAuth: false }
}
```

## ğŸ“Š çŠ¶æ€ç®¡ç†

### LocalStorage å­˜å‚¨

```javascript
// å­˜å‚¨çš„æ•°æ®
{
  token: 'mock_token_xxx',
  userInfo: {
    id: 1,
    username: 'user',
    nickname: 'user',
    avatar: 'https://...'
  }
}
```

### Pinia Store

```javascript
// ç”¨æˆ·çŠ¶æ€
{
  DEV_MODE: true/false,
  userInfo: {...},
  token: 'xxx',
  isLoggedIn: true/false
}
```

---

**é…ç½®å®Œæˆæ—¶é—´ï¼š2024-10-22**

**å¼€å‘æ¨¡å¼ï¼šâœ… å·²å¯ç”¨**

**ç”Ÿäº§æ¨¡å¼ï¼šğŸ”’ å¼ºåˆ¶ç™»å½•**
