import{_,u as h,c as y,r,H as k,a as v,b as n,e as b,y as L,h as $,g as C,i as c,d as S,F as x,j as B,k as M,U as w,s as F}from"./index-PzU3HC5i.js";import{M as N}from"./MusicItem-BfOV4gVI.js";const V={class:"star-page"},j={class:"header"},D={class:"title"},I={key:0,class:"empty"},U={name:"Star"},A=Object.assign(U,{setup(E){const g=h();y(()=>g.currentMusic);const a=r([]),i=r(!1),s=r(!1),l=r(1),d=r(20),p=async()=>{var u,e;try{i.value=!0,console.log(`加载收藏列表第 ${l.value} 页`);const o=await w({page:l.value,limit:d.value}),t=((u=o.data)==null?void 0:u.list)||[],f=((e=o.data)==null?void 0:e.total)||0;t.length>0?(a.value=[...a.value,...t],console.log(`当前 ${a.value.length} 条，共 ${f} 条`),t.length<d.value||a.value.length>=f?(s.value=!0,console.log("✅ 收藏列表加载完成")):(s.value=!1,l.value++,console.log(`准备加载第 ${l.value} 页`))):(l.value===1&&console.log("暂无收藏"),s.value=!0)}catch(o){console.error("加载收藏列表失败:",o),F("加载失败")}finally{i.value=!1}},m=async()=>{if(s.value){console.log("已加载完成，跳过");return}p()};return k(()=>{l.value=1,s.value=!1,a.value=[]}),(u,e)=>{const o=C("van-list");return c(),v("div",V,[n("div",j,[n("i",{class:"fas fa-chevron-left back-btn",onClick:e[0]||(e[0]=t=>u.$router.back())}),n("h1",D,"我的喜欢 ("+L(a.value.length)+")",1),e[2]||(e[2]=n("div",{class:"placeholder"},null,-1))]),b(o,{loading:i.value,"onUpdate:loading":e[1]||(e[1]=t=>i.value=t),finished:s.value,"finished-text":"没有更多了",onLoad:m,class:"content"},{default:$(()=>[a.value.length===0&&!i.value?(c(),v("div",I,[...e[3]||(e[3]=[n("i",{class:"fas fa-heart"},null,-1),n("p",null,"还没有喜欢的歌曲",-1)])])):S("",!0),(c(!0),v(x,null,B(a.value,t=>(c(),M(N,{key:t.id,music:t,playlist:a.value},null,8,["music","playlist"]))),128))]),_:1},8,["loading","finished"])])}}}),T=_(A,[["__scopeId","data-v-aab461da"]]);export{T as default};
