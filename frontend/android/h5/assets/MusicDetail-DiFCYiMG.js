import{_ as $,u as x,r as z,c as m,B as I,p as b,o as T,a as c,b as s,q as g,t as y,v as k,d,y as l,D as E,s as r,E as N,i as u}from"./index-PzU3HC5i.js";const P={class:"music-detail-page"},R={class:"detail-content"},U={class:"top-bar"},V={class:"cover-section"},j={class:"cover-wrapper"},q=["src"],w={key:0,class:"info-section"},O={class:"info-item"},A={class:"value"},G={class:"info-item"},H={class:"value"},J={class:"info-item"},K={class:"value"},L={class:"info-item"},Q={class:"value"},W={class:"info-item"},X={class:"value"},Y={class:"info-item"},Z={class:"value"},ss={key:0,class:"info-item"},as={class:"value"},ts={key:1,class:"actions-section"},os={name:"MusicDetail"},ls=Object.assign(os,{setup(es){const D=I(),h=N(),i=x(),o=z(null),e=m(()=>D.params.id),v=m(()=>o.value?i.isFavorite(o.value.id):!1),f=async()=>{try{console.log("加载音乐详情，ID:",e.value);const t=await E(e.value);t.data&&(o.value=t.data,console.log("音乐详情加载成功:",t.data))}catch(t){console.error("获取歌曲详情失败:",t),r("加载失败"),h.back()}},S=t=>t?(t/(1024*1024)).toFixed(2)+" MB":"未知",M=t=>{if(!t)return"00:00";const a=Math.floor(t/60),n=Math.floor(t%60);return`${a.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`},C=()=>{if(o.value){const t=i.toggleFavorite(o.value);r(t?"已添加到我的喜欢":"已取消喜欢")}},B=()=>{o.value&&(i.addToPlaylist(o.value),r("已添加到播放列表"))},F=()=>{o.value&&r("分享功能开发中")};return b(e,(t,a)=>{console.log("音乐ID变化:",a,"->",t),t&&t!==a&&f()}),b(()=>i.currentMusic,t=>{t&&t.id&&t.id.toString()===e.value&&(console.log("当前播放音乐变化，更新详情"),o.value=t)},{deep:!0}),T(()=>{console.log("MusicDetail 页面挂载，音乐ID:",e.value),f()}),(t,a)=>{var n,p,_;return u(),c("div",P,[s("div",{class:"background",style:g({backgroundImage:`url(${y(k)((n=o.value)==null?void 0:n.cover)})`})},null,4),s("div",R,[s("div",U,[s("i",{class:"fas fa-chevron-left",onClick:a[0]||(a[0]=is=>t.$router.back())}),a[1]||(a[1]=s("span",{class:"title"},"歌曲详情",-1)),a[2]||(a[2]=s("div",{style:{width:"40px"}},null,-1))]),s("div",V,[s("div",j,[s("img",{src:y(k)((p=o.value)==null?void 0:p.cover)},null,8,q)])]),o.value?(u(),c("div",w,[s("div",O,[a[3]||(a[3]=s("span",{class:"label"},"歌曲名称",-1)),s("span",A,l(o.value.name||"未知"),1)]),s("div",G,[a[4]||(a[4]=s("span",{class:"label"},"艺术家",-1)),s("span",H,l(o.value.artist||"未知"),1)]),s("div",J,[a[5]||(a[5]=s("span",{class:"label"},"专辑",-1)),s("span",K,l(o.value.album||"未知"),1)]),s("div",L,[a[6]||(a[6]=s("span",{class:"label"},"时长",-1)),s("span",Q,l(M(o.value.duration)),1)]),s("div",W,[a[7]||(a[7]=s("span",{class:"label"},"格式",-1)),s("span",X,l(((_=o.value.format)==null?void 0:_.toUpperCase())||"未知"),1)]),s("div",Y,[a[8]||(a[8]=s("span",{class:"label"},"文件大小",-1)),s("span",Z,l(S(o.value.size)),1)]),o.value.play_count?(u(),c("div",ss,[a[9]||(a[9]=s("span",{class:"label"},"播放次数",-1)),s("span",as,l(o.value.play_count)+" 次",1)])):d("",!0)])):d("",!0),o.value?(u(),c("div",ts,[s("div",{class:"action-btn",onClick:C},[s("i",{class:"fas fa-heart",style:g({color:v.value?"#ff4757":"#fff"})},null,4),s("span",null,l(v.value?"已收藏":"收藏"),1)]),s("div",{class:"action-btn",onClick:B},[...a[10]||(a[10]=[s("i",{class:"fas fa-step-forward"},null,-1),s("span",null,"下一首播放",-1)])]),s("div",{class:"action-btn",onClick:F},[...a[11]||(a[11]=[s("i",{class:"fas fa-share-alt"},null,-1),s("span",null,"分享",-1)])])])):d("",!0)])])}}}),cs=$(ls,[["__scopeId","data-v-37eb6211"]]);export{cs as default};
