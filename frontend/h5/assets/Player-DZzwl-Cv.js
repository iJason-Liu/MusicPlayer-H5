import{_ as D,u as E,i as c,r as C,j as P,c as r,a as e,n as S,t as i,k as p,F as U,f as q,b as A,e as G,g as d}from"./index-DLFWzj8n.js";import{s as w}from"./function-call-Dqda3pcp.js";const H={class:"player-page"},J={class:"player-content"},K={class:"top-bar"},O={class:"song-info"},Q={class:"name"},R={class:"artist"},W={class:"cover-container"},X={class:"cover-wrapper"},Y=["src"],Z={key:0,class:"lyric-container"},ss={key:1,class:"lyric-container"},es={class:"progress-container"},as={class:"time"},os={class:"time"},ts={class:"controls"},ls={__name:"Player",setup(ns){const o=E(),t=c(()=>o.currentMusic),m=c(()=>o.isPlaying),_=c(()=>o.currentTime),u=c(()=>o.duration),F=c(()=>o.playMode),y=c(()=>t.value?o.isFavorite(t.value.id):!1),f=C(0),g=C([]);P(_,s=>{u.value>0&&(f.value=s/u.value*100)}),P(()=>{var s;return(s=t.value)==null?void 0:s.lyric},s=>{s&&(g.value=j(s))});const I=c(()=>({loop:"fa-repeat",random:"fa-random",single:"fa-redo"})[F.value]),T=()=>{o.togglePlay()},V=()=>{o.playNext()},$=()=>{o.playPrev()},N=s=>{const a=s/100*u.value;o.seek(a)},B=()=>{const s=o.togglePlayMode();w({loop:"列表循环",random:"随机播放",single:"单曲循环"}[s])},L=()=>{if(t.value){const s=o.toggleFavorite(t.value);w(s?"已添加到我的喜欢":"已取消喜欢")}},h=s=>{const a=Math.floor(s/60),l=Math.floor(s%60);return`${a}:${l.toString().padStart(2,"0")}`},j=s=>s.split(`
`).map(l=>{const n=l.match(/\[(\d{2}):(\d{2})\.(\d{2,3})\](.*)/);return n?{time:parseInt(n[1])*60+parseInt(n[2])+parseInt(n[3])/1e3,text:n[4].trim()}:{time:0,text:l}}).filter(l=>l.text);return(s,a)=>{var n,k,x,M,b;const l=G("van-slider");return d(),r("div",H,[e("div",{class:"background",style:S({backgroundImage:`url(${(n=t.value)==null?void 0:n.cover})`})},null,4),e("div",J,[e("div",K,[e("i",{class:"fas fa-chevron-down",onClick:a[0]||(a[0]=v=>s.$router.back())}),e("div",O,[e("div",Q,i(((k=t.value)==null?void 0:k.name)||"暂无播放"),1),e("div",R,i(((x=t.value)==null?void 0:x.artist)||""),1)]),a[2]||(a[2]=e("i",{class:"fas fa-ellipsis-v"},null,-1))]),e("div",W,[e("div",X,[e("img",{src:((M=t.value)==null?void 0:M.cover)||"/default-cover.jpg",class:p(["cover rotating",{paused:!m.value}])},null,10,Y)])]),(b=t.value)!=null&&b.lyric?(d(),r("div",Z,[(d(!0),r(U,null,q(g.value,(v,z)=>(d(),r("div",{class:"lyric-line",key:z},i(v.text),1))),128))])):(d(),r("div",ss,[...a[3]||(a[3]=[e("div",{class:"no-lyric"},"暂无歌词",-1)])])),e("div",es,[e("span",as,i(h(_.value)),1),A(l,{modelValue:f.value,"onUpdate:modelValue":a[1]||(a[1]=v=>f.value=v),onChange:N,"bar-height":3,"active-color":"#fff","inactive-color":"rgba(255,255,255,0.3)"},null,8,["modelValue"]),e("span",os,i(h(u.value)),1)]),e("div",ts,[e("i",{class:p(["fas control-icon",I.value]),onClick:B},null,2),e("i",{class:"fas fa-step-backward control-icon",onClick:$}),e("i",{class:p(["fas control-icon play-btn",m.value?"fa-pause-circle":"fa-play-circle"]),onClick:T},null,2),e("i",{class:"fas fa-step-forward control-icon",onClick:V}),e("i",{class:p(["fas control-icon",(y.value,"fa-heart")]),style:S({color:y.value?"#ff4757":"#fff"}),onClick:L},null,6)])])])}}},is=D(ls,[["__scopeId","data-v-f8fe2d23"]]);export{is as default};
