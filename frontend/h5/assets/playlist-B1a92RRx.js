import{ac as v,r as i,c as w,ad as P,ae as m,af as g,ag as h,ah as p,ai as S,aj as M}from"./index-BgLcfbKB.js";const x=v("playlist",()=>{const o=i([]),l=i(null),n=i(!1),u=w(()=>JSON.parse(localStorage.getItem("playlist")||"[]").length),s=async()=>{n.value=!0;try{const a=await P();a.data&&a.data.list?o.value=a.data.list:a.data&&Array.isArray(a.data)&&(o.value=a.data)}catch(a){console.error("加载播放列表失败:",a)}finally{n.value=!1}},y=async(a,t="",r="")=>{try{const e=await m({name:a,cover:t,description:r});return e.data?(await s(),e.data.id):null}catch(e){return console.error("创建播放列表失败:",e),null}},d=async(a,t)=>{try{return await g({id:a,...t}),await s(),!0}catch(r){return console.error("更新播放列表失败:",r),!1}},f=async a=>{var t;try{return await h(a),o.value=o.value.filter(r=>r.id!==a),((t=l.value)==null?void 0:t.id)===a&&(l.value=null),!0}catch(r){return console.error("删除播放列表失败:",r),!1}},c=async a=>{n.value=!0;try{const t=await p(a);return t.data?(l.value=t.data,t.data):null}catch(t){return console.error("获取播放列表详情失败:",t),null}finally{n.value=!1}};return{playlists:o,currentPlaylist:l,loading:n,loadPlaylists:s,create:y,update:d,remove:f,loadPlaylistDetail:c,addMusic:async(a,t)=>{var r;try{return await S(a,t),((r=l.value)==null?void 0:r.id)===a&&await c(a),await s(),!0}catch(e){return console.error("添加音乐到播放列表失败:",e),!1}},removeMusic:async(a,t)=>{var r;try{return await M(a,t),((r=l.value)==null?void 0:r.id)===a&&await c(a),await s(),!0}catch(e){return console.error("从播放列表移除音乐失败:",e),!1}},initStore:async()=>{localStorage.getItem("token")&&await s()},playlistCount:u}});export{x as usePlaylistStore};
