import{_ as K,u as Q,c,r as m,m as I,a as d,b as s,p as $,q as _,t as W,v,x as y,F as X,j as Y,e as Z,g as ee,s as k,y as se,i as f}from"./index-BgLcfbKB.js";const ae={class:"player-page"},te={class:"player-content"},oe={class:"top-bar"},le={class:"song-info"},ne={class:"name"},ce={class:"artist"},re={class:"cover-container"},ie={class:"cover-wrapper"},ue=["src"],de={key:0,class:"lyric-container"},ve={key:1,class:"lyric-container"},fe={class:"progress-container"},pe={class:"time"},ge={class:"time"},me={class:"controls"},_e={name:"Player"},ye=Object.assign(_e,{setup(he){const B=se(),t=Q(),p=W("imgPath"),a=c(()=>t.currentMusic),x=c(()=>t.isPlaying),P=c(()=>t.currentTime),i=c(()=>t.duration),N=c(()=>t.playMode),b=c(()=>a.value?t.isFavorite(a.value.id):!1),r=m(0),C=m([]),u=m(!1),h=m(0);I(P,e=>{!u.value&&i.value>0&&(r.value=e/i.value*100)}),I(()=>{var e;return(e=a.value)==null?void 0:e.lyric},e=>{e&&(C.value=G(e))});const j=c(()=>({loop:"fa-repeat",random:"fa-random",single:"fa-redo"})[N.value]),z=()=>{t.togglePlay()},L=()=>{t.playNext()},q=()=>{t.playPrev()},E=()=>{u.value=!0,h.value=r.value},O=e=>{u.value&&(h.value=e,r.value=e)},R=e=>{u.value=!1;const o=e/100*i.value;t.seek(o),r.value=e},U=()=>{const e=t.togglePlayMode();k({loop:"列表循环",random:"随机播放",single:"单曲循环"}[e])},A=()=>{if(a.value){const e=t.toggleFavorite(a.value);k(e?"已添加到我的喜欢":"已取消喜欢")}},M=e=>{const o=Math.floor(e/60),l=Math.floor(e%60);return`${o}:${l.toString().padStart(2,"0")}`},G=e=>e.split(`
`).map(l=>{const n=l.match(/\[(\d{2}):(\d{2})\.(\d{2,3})\](.*)/);return n?{time:parseInt(n[1])*60+parseInt(n[2])+parseInt(n[3])/1e3,text:n[4].trim()}:{time:0,text:l}}).filter(l=>l.text),H=()=>{if(!a.value){k("当前没有播放歌曲");return}B.push(`/music/${a.value.id}`)};return(e,o)=>{var n,S,D,T,V,w,F;const l=ee("van-slider");return f(),d("div",ae,[s("div",{class:"background",style:$({backgroundImage:`url(${(n=a.value)!=null&&n.cover?_(p)+((S=a.value)==null?void 0:S.cover):_(p)+"/storage/20251103/dxP1762151275usfDcB1.png"})`})},null,4),s("div",te,[s("div",oe,[s("i",{class:"fas fa-chevron-down",onClick:o[0]||(o[0]=g=>e.$router.back())}),s("div",le,[s("div",ne,v(((D=a.value)==null?void 0:D.name)||"暂无播放"),1),s("div",ce,v(((T=a.value)==null?void 0:T.artist)||""),1)]),s("i",{class:"fas fa-ellipsis-v",onClick:H})]),s("div",re,[s("div",ie,[s("img",{src:(V=a.value)!=null&&V.cover?_(p)+((w=a.value)==null?void 0:w.cover):_(p)+"/storage/20251103/dxP1762151275usfDcB1.png",class:y(["cover rotating",{paused:!x.value}])},null,10,ue)])]),(F=a.value)!=null&&F.lyric?(f(),d("div",de,[(f(!0),d(X,null,Y(C.value,(g,J)=>(f(),d("div",{class:"lyric-line",key:J},v(g.text),1))),128))])):(f(),d("div",ve,[...o[2]||(o[2]=[s("div",{class:"no-lyric"},"暂无歌词",-1)])])),s("div",fe,[s("span",pe,v(M(u.value?h.value/100*i.value:P.value)),1),Z(l,{modelValue:r.value,"onUpdate:modelValue":[o[1]||(o[1]=g=>r.value=g),O],onChange:R,onDragStart:E,"bar-height":4,"button-size":16,"active-color":"#fff","inactive-color":"rgba(255,255,255,0.3)"},null,8,["modelValue"]),s("span",ge,v(M(i.value)),1)]),s("div",me,[s("i",{class:y(["fas control-icon",j.value]),onClick:U},null,2),s("i",{class:"fas fa-step-backward control-icon",onClick:q}),s("i",{class:y(["fas control-icon play-btn",x.value?"fa-pause-circle":"fa-play-circle"]),onClick:z},null,2),s("i",{class:"fas fa-step-forward control-icon",onClick:L}),s("i",{class:y(["fas control-icon",(b.value,"fa-heart")]),style:$({color:b.value?"#ff4757":"#fff"}),onClick:A},null,6)])])])}}}),xe=K(ye,[["__scopeId","data-v-c454f80c"]]);export{xe as default};
